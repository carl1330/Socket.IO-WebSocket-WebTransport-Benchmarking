<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Sample Site</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <style>
      body {
        padding-top: 50px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <button onclick="handleWebSocket()" class="btn btn-primary">
        WebSocket
      </button>
      <button onclick="handleWebTransport()" class="btn btn-primary">
        WebTransport
      </button>
      <p>Status: <span id="status">Disconnected</span></p>
      <p>Transport: <span id="transport">N/A</span></p>
    </div>
  </body>
  <script>
    const $status = document.getElementById("status");
    const $transport = document.getElementById("transport");

    function handleWebSocket() {
      const socket = io("localhost:3000");

      socket.on("connect", () => {
        console.log(
          `connected with transport ${socket.io.engine.transport.name}`
        );

        $status.innerText = "Connected";
        $transport.innerText = socket.io.engine.transport.name;

        socket.io.engine.on("upgrade", (transport) => {
          console.log(`transport upgraded to ${transport.name}`);

          $transport.innerText = transport.name;
        });
      });
    }

    function handleWebTransport() {
      const socket = io("localhost:1337", {
        transportOptions: {
          webtransport: {
            hostname: "127.0.0.1",
          },
        },
      });

      socket.on("connect", () => {
        console.log(
          `connected with transport ${socket.io.engine.transport.name}`
        );

        $status.innerText = "Connected";
        $transport.innerText = socket.io.engine.transport.name;

        socket.io.engine.on("upgrade", (transport) => {
          console.log(`transport upgraded to ${transport.name}`);

          $transport.innerText = transport.name;
        });
      });
    }
  </script>
</html>
